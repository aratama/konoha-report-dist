var Ue,g,un,le,kt,dn,rt,pt,ot,it,Xn=Object.defineProperty,Wn=(e,t,n)=>t in e?Xn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Je=(e,t,n)=>(Wn(e,"symbol"!=typeof t?t+"":t,n),n),be={},hn=[],Gn=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,ze=Array.isArray;function te(e,t){for(var n in t)e[n]=t[n];return e}function pn(e){var t=e.parentNode;t&&t.removeChild(e)}function ke(e,t,n){var r,o,i,a={};for(i in t)"key"==i?r=t[i]:"ref"==i?o=t[i]:a[i]=t[i];if(arguments.length>2&&(a.children=arguments.length>3?Ue.call(arguments,2):n),"function"==typeof e&&null!=e.defaultProps)for(i in e.defaultProps)void 0===a[i]&&(a[i]=e.defaultProps[i]);return Te(e,a,r,o,null)}function Te(e,t,n,r,o){var i={type:e,props:t,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:o??++un,__i:-1,__u:0};return null==o&&null!=g.vnode&&g.vnode(i),i}function D(e){return e.children}function Q(e,t){this.props=e,this.context=t}function ue(e,t){if(null==t)return e.__?ue(e.__,e.__i+1):null;for(var n;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e)return n.__e;return"function"==typeof e.type?ue(e):null}function _n(e){var t,n;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e){e.__e=e.__c.base=n.__e;break}return _n(e)}}function St(e){(!e.__d&&(e.__d=!0)&&le.push(e)&&!Oe.__r++||kt!==g.debounceRendering)&&((kt=g.debounceRendering)||dn)(Oe)}function Oe(){var e,t,n,r,o,i,a,l;for(le.sort(rt);e=le.shift();)e.__d&&(t=le.length,r=void 0,i=(o=(n=e).__v).__e,a=[],l=[],n.__P&&((r=te({},o)).__v=o.__v+1,g.vnode&&g.vnode(r),_t(n.__P,r,o,n.__n,void 0!==n.__P.ownerSVGElement,32&o.__u?[i]:null,a,i??ue(o),!!(32&o.__u),l),r.__v=o.__v,r.__.__k[r.__i]=r,mn(a,r,l),r.__e!=i&&_n(r)),le.length>t&&le.sort(rt));Oe.__r=0}function fn(e,t,n,r,o,i,a,l,s,c,u){var d,p,h,_,f,g=r&&r.__k||hn,y=t.length;for(n.__d=s,Zn(n,t,g),s=n.__d,d=0;d<y;d++)null!=(h=n.__k[d])&&"boolean"!=typeof h&&"function"!=typeof h&&(p=-1===h.__i?be:g[h.__i]||be,h.__i=d,_t(e,h,p,o,i,a,l,s,c,u),_=h.__e,h.ref&&p.ref!=h.ref&&(p.ref&&ft(p.ref,null,h),u.push(h.ref,h.__c||_,h)),null==f&&null!=_&&(f=_),65536&h.__u||p.__k===h.__k?(s&&!s.isConnected&&(s=ue(p)),s=yn(h,s,e)):"function"==typeof h.type&&void 0!==h.__d?s=h.__d:_&&(s=_.nextSibling),h.__d=void 0,h.__u&=-196609);n.__d=s,n.__e=f}function Zn(e,t,n){var r,o,i,a,l,s=t.length,c=n.length,u=c,d=0;for(e.__k=[],r=0;r<s;r++)a=r+d,null!=(o=e.__k[r]=null==(o=t[r])||"boolean"==typeof o||"function"==typeof o?null:"string"==typeof o||"number"==typeof o||"bigint"==typeof o||o.constructor==String?Te(null,o,null,null,null):ze(o)?Te(D,{children:o},null,null,null):void 0===o.constructor&&o.__b>0?Te(o.type,o.props,o.key,o.ref?o.ref:null,o.__v):o)?(o.__=e,o.__b=e.__b+1,l=Jn(o,n,a,u),o.__i=l,i=null,-1!==l&&(u--,(i=n[l])&&(i.__u|=131072)),null==i||null===i.__v?(-1==l&&d--,"function"!=typeof o.type&&(o.__u|=65536)):l!==a&&(l===a+1?d++:l>a?u>s-a?d+=l-a:d--:l<a?l==a-1&&(d=l-a):d=0,l!==r+d&&(o.__u|=65536))):(i=n[a])&&null==i.key&&i.__e&&!(131072&i.__u)&&(i.__e==e.__d&&(e.__d=ue(i)),at(i,i,!1),n[a]=null,u--);if(u)for(r=0;r<c;r++)null!=(i=n[r])&&!(131072&i.__u)&&(i.__e==e.__d&&(e.__d=ue(i)),at(i,i))}function yn(e,t,n){var r,o;if("function"==typeof e.type){for(r=e.__k,o=0;r&&o<r.length;o++)r[o]&&(r[o].__=e,t=yn(r[o],t,n));return t}e.__e!=t&&(n.insertBefore(e.__e,t||null),t=e.__e);do{t=t&&t.nextSibling}while(null!=t&&8===t.nodeType);return t}function Fe(e,t){return t=t||[],null==e||"boolean"==typeof e||(ze(e)?e.some((function(e){Fe(e,t)})):t.push(e)),t}function Jn(e,t,n,r){var o=e.key,i=e.type,a=n-1,l=n+1,s=t[n];if(null===s||s&&o==s.key&&i===s.type&&!(131072&s.__u))return n;if(r>(null==s||131072&s.__u?0:1))for(;a>=0||l<t.length;){if(a>=0){if((s=t[a])&&!(131072&s.__u)&&o==s.key&&i===s.type)return a;a--}if(l<t.length){if((s=t[l])&&!(131072&s.__u)&&o==s.key&&i===s.type)return l;l++}}return-1}function Pt(e,t,n){"-"===t[0]?e.setProperty(t,n??""):e[t]=null==n?"":"number"!=typeof n||Gn.test(t)?n:n+"px"}function Ce(e,t,n,r,o){var i;e:if("style"===t)if("string"==typeof n)e.style.cssText=n;else{if("string"==typeof r&&(e.style.cssText=r=""),r)for(t in r)n&&t in n||Pt(e.style,t,"");if(n)for(t in n)r&&n[t]===r[t]||Pt(e.style,t,n[t])}else if("o"===t[0]&&"n"===t[1])i=t!==(t=t.replace(/(PointerCapture)$|Capture$/i,"$1")),t=t.toLowerCase()in e||"onFocusOut"===t||"onFocusIn"===t?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+i]=n,n?r?n.u=r.u:(n.u=pt,e.addEventListener(t,i?it:ot,i)):e.removeEventListener(t,i?it:ot,i);else{if(o)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("width"!=t&&"height"!=t&&"href"!=t&&"list"!=t&&"form"!=t&&"tabIndex"!=t&&"download"!=t&&"rowSpan"!=t&&"colSpan"!=t&&"role"!=t&&t in e)try{e[t]=n??"";break e}catch{}"function"==typeof n||(null==n||!1===n&&"-"!==t[4]?e.removeAttribute(t):e.setAttribute(t,n))}}function $t(e){return function(t){if(this.l){var n=this.l[t.type+e];if(null==t.t)t.t=pt++;else if(t.t<n.u)return;return n(g.event?g.event(t):t)}}}function _t(e,t,n,r,o,i,a,l,s,c){var u,d,p,h,_,f,y,v,m,x,w,b,k,S,P,M=t.type;if(void 0!==t.constructor)return null;128&n.__u&&(s=!!(32&n.__u),i=[l=t.__e=n.__e]),(u=g.__b)&&u(t);e:if("function"==typeof M)try{if(v=t.props,m=(u=M.contextType)&&r[u.__c],x=u?m?m.props.value:u.__:r,n.__c?y=(d=t.__c=n.__c).__=d.__E:("prototype"in M&&M.prototype.render?t.__c=d=new M(v,x):(t.__c=d=new Q(v,x),d.constructor=M,d.render=Qn),m&&m.sub(d),d.props=v,d.state||(d.state={}),d.context=x,d.__n=r,p=d.__d=!0,d.__h=[],d._sb=[]),null==d.__s&&(d.__s=d.state),null!=M.getDerivedStateFromProps&&(d.__s==d.state&&(d.__s=te({},d.__s)),te(d.__s,M.getDerivedStateFromProps(v,d.__s))),h=d.props,_=d.state,d.__v=t,p)null==M.getDerivedStateFromProps&&null!=d.componentWillMount&&d.componentWillMount(),null!=d.componentDidMount&&d.__h.push(d.componentDidMount);else{if(null==M.getDerivedStateFromProps&&v!==h&&null!=d.componentWillReceiveProps&&d.componentWillReceiveProps(v,x),!d.__e&&(null!=d.shouldComponentUpdate&&!1===d.shouldComponentUpdate(v,d.__s,x)||t.__v===n.__v)){for(t.__v!==n.__v&&(d.props=v,d.state=d.__s,d.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.forEach((function(e){e&&(e.__=t)})),w=0;w<d._sb.length;w++)d.__h.push(d._sb[w]);d._sb=[],d.__h.length&&a.push(d);break e}null!=d.componentWillUpdate&&d.componentWillUpdate(v,d.__s,x),null!=d.componentDidUpdate&&d.__h.push((function(){d.componentDidUpdate(h,_,f)}))}if(d.context=x,d.props=v,d.__P=e,d.__e=!1,b=g.__r,k=0,"prototype"in M&&M.prototype.render){for(d.state=d.__s,d.__d=!1,b&&b(t),u=d.render(d.props,d.state,d.context),S=0;S<d._sb.length;S++)d.__h.push(d._sb[S]);d._sb=[]}else do{d.__d=!1,b&&b(t),u=d.render(d.props,d.state,d.context),d.state=d.__s}while(d.__d&&++k<25);d.state=d.__s,null!=d.getChildContext&&(r=te(te({},r),d.getChildContext())),p||null==d.getSnapshotBeforeUpdate||(f=d.getSnapshotBeforeUpdate(h,_)),fn(e,ze(P=null!=u&&u.type===D&&null==u.key?u.props.children:u)?P:[P],t,n,r,o,i,a,l,s,c),d.base=t.__e,t.__u&=-161,d.__h.length&&a.push(d),y&&(d.__E=d.__=null)}catch(e){t.__v=null,s||null!=i?(t.__e=l,t.__u|=s?160:32,i[i.indexOf(l)]=null):(t.__e=n.__e,t.__k=n.__k),g.__e(e,t,n)}else null==i&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=qn(n.__e,t,n,r,o,i,a,s,c);(u=g.diffed)&&u(t)}function mn(e,t,n){t.__d=void 0;for(var r=0;r<n.length;r++)ft(n[r],n[++r],n[++r]);g.__c&&g.__c(t,e),e.some((function(t){try{e=t.__h,t.__h=[],e.some((function(e){e.call(t)}))}catch(e){g.__e(e,t.__v)}}))}function qn(e,t,n,r,o,i,a,l,s){var c,u,d,p,h,_,f,g=n.props,y=t.props,v=t.type;if("svg"===v&&(o=!0),null!=i)for(c=0;c<i.length;c++)if((h=i[c])&&"setAttribute"in h==!!v&&(v?h.localName===v:3===h.nodeType)){e=h,i[c]=null;break}if(null==e){if(null===v)return document.createTextNode(y);e=o?document.createElementNS("http://www.w3.org/2000/svg",v):document.createElement(v,y.is&&y),i=null,l=!1}if(null===v)g===y||l&&e.data===y||(e.data=y);else{if(i=i&&Ue.call(e.childNodes),g=n.props||be,!l&&null!=i)for(g={},c=0;c<e.attributes.length;c++)g[(h=e.attributes[c]).name]=h.value;for(c in g)h=g[c],"children"==c||("dangerouslySetInnerHTML"==c?d=h:"key"===c||c in y||Ce(e,c,null,h,o));for(c in y)h=y[c],"children"==c?p=h:"dangerouslySetInnerHTML"==c?u=h:"value"==c?_=h:"checked"==c?f=h:"key"===c||l&&"function"!=typeof h||g[c]===h||Ce(e,c,h,g[c],o);if(u)l||d&&(u.__html===d.__html||u.__html===e.innerHTML)||(e.innerHTML=u.__html),t.__k=[];else if(d&&(e.innerHTML=""),fn(e,ze(p)?p:[p],t,n,r,o&&"foreignObject"!==v,i,a,i?i[0]:n.__k&&ue(n,0),l,s),null!=i)for(c=i.length;c--;)null!=i[c]&&pn(i[c]);l||(c="value",void 0!==_&&(_!==e[c]||"progress"===v&&!_||"option"===v&&_!==g[c])&&Ce(e,c,_,g[c],!1),c="checked",void 0!==f&&f!==e[c]&&Ce(e,c,f,g[c],!1))}return e}function ft(e,t,n){try{"function"==typeof e?e(t):e.current=t}catch(e){g.__e(e,n)}}function at(e,t,n){var r,o;if(g.unmount&&g.unmount(e),(r=e.ref)&&(r.current&&r.current!==e.__e||ft(r,null,t)),null!=(r=e.__c)){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(e){g.__e(e,t)}r.base=r.__P=null}if(r=e.__k)for(o=0;o<r.length;o++)r[o]&&at(r[o],t,n||"function"!=typeof e.type);n||null==e.__e||pn(e.__e),e.__c=e.__=e.__e=e.__d=void 0}function Qn(e,t,n){return this.constructor(e,n)}function Kn(e,t,n){var r,o,i,a;g.__&&g.__(e,t),o=(r="function"==typeof n)?null:n&&n.__k||t.__k,i=[],a=[],_t(t,e=(!r&&n||t).__k=ke(D,null,[e]),o||be,be,void 0!==t.ownerSVGElement,!r&&n?[n]:o?null:t.firstChild?Ue.call(t.childNodes):null,i,!r&&n?n:o?o.__e:t.firstChild,r,a),mn(i,e,a)}Ue=hn.slice,g={__e:function(e,t,n,r){for(var o,i,a;t=t.__;)if((o=t.__c)&&!o.__)try{if((i=o.constructor)&&null!=i.getDerivedStateFromError&&(o.setState(i.getDerivedStateFromError(e)),a=o.__d),null!=o.componentDidCatch&&(o.componentDidCatch(e,r||{}),a=o.__d),a)return o.__E=o}catch(t){e=t}throw e}},un=0,Q.prototype.setState=function(e,t){var n;n=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=te({},this.state),"function"==typeof e&&(e=e(te({},n),this.props)),e&&te(n,e),null!=e&&this.__v&&(t&&this._sb.push(t),St(this))},Q.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),St(this))},Q.prototype.render=D,le=[],dn="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,rt=function(e,t){return e.__v.__b-t.__v.__b},Oe.__r=0,pt=0,ot=$t(!1),it=$t(!0);const er='@import"https://fonts.googleapis.com/css2?family=M+PLUS+1+Code:wght@100..700&family=Noto+Sans+JP:wght@300&family=Noto+Serif+JP:wght@300&family=Roboto+Mono:ital,wght@0,100..700;1,100..700&display=swap";button{font-family:Yu Mincho,YuMincho}.anchor{fill:#fff;stroke:#333}.anchor:hover{fill:green}.anchor.selected{fill:red}.page{filter:drop-shadow(0px 0px 30px rgba(0,0,0,.2))}.page-id{fill:#aaa;font-family:"M PLUS 1 Code",monospace;font-size:16px;pointer-events:none}svg *{-webkit-user-select:none;user-select:none;font-family:Yu Mincho,YuMincho}.app-root{display:flex;height:100%;overflow:hidden;color:#fff;font-family:"M PLUS 1 Code",monospace}.left-panel{width:20%;background-color:#888;flex-shrink:0;flex-grow:0;display:flex;flex-direction:column;position:relative}.left-panel .tabs{display:flex;flex-direction:row}.left-panel .tabs .tab{flex-shrink:1;flex-grow:1;margin:4px;opacity:.5}.left-panel .tabs .tab.active{opacity:1}.component-data-preview{background-color:#333;color:#fff;font-family:"M PLUS 1 Code",monospace;overflow:scroll;scrollbar-width:none}.component-data-preview .row{overflow:hidden}.component-data-preview .row:hover{background-color:#888}.component-data-preview .row:nth-child(odd){background-color:#383838}.component-data-preview .row:nth-child(odd):hover{background-color:#888}.component-data-preview .row .key{white-space:nowrap}.component-data-preview .row .value{opacity:.3;margin-left:.5em;white-space:nowrap}.coords{fill:#fff;opacity:.5;font-family:"M PLUS 1 Code",monospace}svg{background-color:#111}.background-grid-cell{fill:#151515}.transform-transition{transition-property:transform;transition-duration:.3s}button{border-radius:8px;border:1px solid transparent;padding:.1em .6em;font-size:1em;font-weight:500;font-family:inherit;background-color:#1a1a1a;color:#ccc;cursor:pointer;transition-property:border-color opacity;transition-duration:.25s}button:hover{border-color:#646cff}.icon-button{display:flex;align-items:center;gap:.5em;font-family:"M PLUS 1 Code",monospace}.icon-button svg{width:1em;height:1em}textarea{width:100%;white-space:nowrap;border:none;margin:0;padding:.5em}td{margin:0;padding:0}input.number{background-color:transparent;border:none;outline:none;color:#fff}input.number:focus{background-color:#fff;color:#000}input.text{background-color:transparent;border:none;outline:none;color:#fff}input.text:focus{background-color:#fff;color:#000}';var me,M,qe,Dt,Se=0,vn=[],Ie=[],T=g,Ct=T.__b,Et=T.__r,Mt=T.diffed,At=T.__c,Tt=T.unmount,It=T.__;function Be(e,t){T.__h&&T.__h(M,e,Se||t),Se=0;var n=M.__H||(M.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({__V:Ie}),n.__[e]}function j(e){return Se=1,tr(wn,e)}function tr(e,t,n){var r=Be(me++,2);if(r.t=e,!r.__c&&(r.__=[n?n(t):wn(void 0,t),function(e){var t=r.__N?r.__N[0]:r.__[0],n=r.t(t,e);t!==n&&(r.__N=[n,r.__[1]],r.__c.setState({}))}],r.__c=M,!M.u)){var o=function(e,t,n){if(!r.__c.__H)return!0;var o=r.__c.__H.__.filter((function(e){return!!e.__c}));if(o.every((function(e){return!e.__N})))return!i||i.call(this,e,t,n);var a=!1;return o.forEach((function(e){if(e.__N){var t=e.__[0];e.__=e.__N,e.__N=void 0,t!==e.__[0]&&(a=!0)}})),!(!a&&r.__c.props===e)&&(!i||i.call(this,e,t,n))};M.u=!0;var i=M.shouldComponentUpdate,a=M.componentWillUpdate;M.componentWillUpdate=function(e,t,n){if(this.__e){var r=i;i=void 0,o(e,t,n),i=r}a&&a.call(this,e,t,n)},M.shouldComponentUpdate=o}return r.__N||r.__}function Ye(e,t){var n=Be(me++,3);!T.__s&&xn(n.__H,t)&&(n.__=e,n.i=t,M.__H.__h.push(n))}function gn(e){return Se=5,ce((function(){return{current:e}}),[])}function ce(e,t){var n=Be(me++,7);return xn(n.__H,t)?(n.__V=e(),n.i=t,n.__h=e,n.__V):n.__}function ye(e,t){return Se=8,ce((function(){return e}),t)}function yt(){var e=Be(me++,11);if(!e.__){for(var t=M.__v;null!==t&&!t.__m&&null!==t.__;)t=t.__;var n=t.__m||(t.__m=[0,0]);e.__="P"+n[0]+"-"+n[1]++}return e.__}function nr(){for(var e;e=vn.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(Le),e.__H.__h.forEach(st),e.__H.__h=[]}catch(t){e.__H.__h=[],T.__e(t,e.__v)}}T.__b=function(e){M=null,Ct&&Ct(e)},T.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),It&&It(e,t)},T.__r=function(e){Et&&Et(e),me=0;var t=(M=e.__c).__H;t&&(qe===M?(t.__h=[],M.__h=[],t.__.forEach((function(e){e.__N&&(e.__=e.__N),e.__V=Ie,e.__N=e.i=void 0}))):(t.__h.forEach(Le),t.__h.forEach(st),t.__h=[],me=0)),qe=M},T.diffed=function(e){Mt&&Mt(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==vn.push(t)&&Dt===T.requestAnimationFrame||((Dt=T.requestAnimationFrame)||rr)(nr)),t.__H.__.forEach((function(e){e.i&&(e.__H=e.i),e.__V!==Ie&&(e.__=e.__V),e.i=void 0,e.__V=Ie}))),qe=M=null},T.__c=function(e,t){t.some((function(e){try{e.__h.forEach(Le),e.__h=e.__h.filter((function(e){return!e.__||st(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],T.__e(n,e.__v)}})),At&&At(e,t)},T.unmount=function(e){Tt&&Tt(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach((function(e){try{Le(e)}catch(e){t=e}})),n.__H=void 0,t&&T.__e(t,n.__v))};var Lt="function"==typeof requestAnimationFrame;function rr(e){var t,n=function(){clearTimeout(r),Lt&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);Lt&&(t=requestAnimationFrame(n))}function Le(e){var t=M,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),M=t}function st(e){var t=M;e.__c=e.__(),M=t}function xn(e,t){return!e||e.length!==t.length||t.some((function(t,n){return t!==e[n]}))}function wn(e,t){return"function"==typeof t?t(e):t}var B,Qe,Ke,et,or=class extends Error{constructor(e){super(e[0].message),Je(this,"issues"),this.name="ValiError",this.issues=e}};function Ve(e,t,n,r,o){return{issues:[{context:e,reference:t,input:n,label:r,received:o}]}}function Xe(e){return{output:e}}function ve(e,t){return Array.isArray(e)?[void 0,e]:[e,t]}function bn(e){return{lang:(null==e?void 0:e.lang)??(null==B?void 0:B.lang),message:null==e?void 0:e.message,abortEarly:(null==e?void 0:e.abortEarly)??(null==B?void 0:B.abortEarly),abortPipeEarly:(null==e?void 0:e.abortPipeEarly)??(null==B?void 0:B.abortPipeEarly),skipPipe:(null==e?void 0:e.skipPipe)??(null==B?void 0:B.skipPipe)}}function ir(e){return null==Qe?void 0:Qe.get(e)}function ar(e){return null==Ke?void 0:Ke.get(e)}function sr(e,t){var n;return null==(n=null==et?void 0:et.get(e))?void 0:n.get(t)}function kn(e,t,n,r,o){const i=t.message??sr(n,o.lang)??(e?ar(o.lang):null)??(null==r?void 0:r.message)??ir(o.lang)??o.message;return"function"==typeof i?i(o):i}function pe(e,t,n){return{typed:e,output:t,issues:n}}function ge(e){let t=typeof e;return"object"===t&&(t=e?Object.getPrototypeOf(e).constructor.name:"null"),"string"===t?`"${e}"`:"number"===t||"bigint"===t||"boolean"===t?`${e}`:t}function lr(e,t,n){const r=n.received??ge(n.input),o={reason:e.type,context:n.context.type,expected:n.context.expects,received:r,message:`Invalid ${n.label}: ${n.context.expects?`Expected ${n.context.expects} but r`:"R"}eceived ${r}`,input:n.input,requirement:n.context.requirement,path:n.path,lang:null==t?void 0:t.lang,abortEarly:null==t?void 0:t.abortEarly,abortPipeEarly:null==t?void 0:t.abortPipeEarly,skipPipe:null==t?void 0:t.skipPipe};return o.message=kn(!1,n.context,n.reference,t,o),o}function de(e,t,n,r){if(e.pipe&&(null==n||!n.skipPipe))for(const o of e.pipe){const i=o._parse(t);if(i.issues){for(const t of i.issues){const o=lr(e,n,t);r?r.push(o):r=[o]}if(null!=n&&n.abortEarly||null!=n&&n.abortPipeEarly)break}else t=i.output}return pe(!0,t,r)}function cr(e,t,n){if(!e||"object"==typeof e&&!Array.isArray(e)){const[r,o]=ve(t,n);return[e,r,o]}const[r,o]=ve(e,t);return[void 0,r,o]}function ne(e,t,n,r,o){const i=ge(n),a=(null==o?void 0:o.expected)??e.expects,l={reason:(null==o?void 0:o.reason)??"type",context:e.type,expected:a,received:i,message:`Invalid type: Expected ${a} but received ${i}`,input:n,path:null==o?void 0:o.path,issues:null==o?void 0:o.issues,lang:null==r?void 0:r.lang,abortEarly:null==r?void 0:r.abortEarly,abortPipeEarly:null==r?void 0:r.abortPipeEarly,skipPipe:null==r?void 0:r.skipPipe};return l.message=kn(!0,e,t,r,l),{typed:!1,output:n,issues:[l]}}function ur(e,t){return"function"==typeof e.fallback?e.fallback(t):e.fallback}function Sn(e,t){return{...e,fallback:t,_parse(t,n){const r=e._parse(t,n);return r.issues?pe(!0,ur(this,{input:t,issues:r.issues})):r}}}function dr(e){return"function"==typeof e.default?e.default():e.default}function De(e,t,n){const[r,o]=ve(t,n);return{type:"array",expects:"Array",async:!1,item:e,message:r,pipe:o,_parse(e,t){if(Array.isArray(e)){let n,r=!0;const o=[];for(let i=0;i<e.length;i++){const a=e[i],l=this.item._parse(a,t);if(l.issues){const o={type:"array",origin:"value",input:e,key:i,value:a};for(const e of l.issues)e.path?e.path.unshift(o):e.path=[o],null==n||n.push(e);if(n||(n=l.issues),null!=t&&t.abortEarly){r=!1;break}}l.typed||(r=!1),o.push(l.output)}return r?de(this,o,t,n):pe(!1,o,n)}return ne(this,De,e,t)}}}function We(e,t){return{type:"literal",expects:ge(e),async:!1,literal:e,message:t,_parse(e,t){return e===this.literal?pe(!0,e):ne(this,We,e,t)}}}function I(e,t){const[n,r]=ve(e,t);return{type:"number",expects:"number",async:!1,message:n,pipe:r,_parse(e,t){return"number"!=typeof e||isNaN(e)?ne(this,I,e,t):de(this,e,t)}}}function _e(e,t,n,r){const[o,i,a]=cr(t,n,r);let l;return{type:"object",expects:"Object",async:!1,entries:e,rest:o,message:i,pipe:a,_parse(e,t){if(e&&"object"==typeof e){l=l??Object.entries(this.entries);let n,r=!0;const o={};for(const[i,a]of l){const l=e[i],s=a._parse(l,t);if(s.issues){const o={type:"object",origin:"value",input:e,key:i,value:l};for(const e of s.issues)e.path?e.path.unshift(o):e.path=[o],null==n||n.push(e);if(n||(n=s.issues),null!=t&&t.abortEarly){r=!1;break}}s.typed||(r=!1),(void 0!==s.output||i in e)&&(o[i]=s.output)}if(this.rest&&(null==t||!t.abortEarly||!n))for(const i in e)if(!(i in this.entries)){const a=e[i],l=this.rest._parse(a,t);if(l.issues){const o={type:"object",origin:"value",input:e,key:i,value:a};for(const e of l.issues)e.path?e.path.unshift(o):e.path=[o],null==n||n.push(e);if(n||(n=l.issues),null!=t&&t.abortEarly){r=!1;break}}l.typed||(r=!1),o[i]=l.output}return r?de(this,o,t,n):pe(!1,o,n)}return ne(this,_e,e,t)}}}function R(e,t){return{type:"optional",expects:`${e.expects} | undefined`,async:!1,wrapped:e,default:t,_parse(e,t){if(void 0===e){const t=dr(this);if(void 0===t)return pe(!0,e);e=t}return this.wrapped._parse(e,t)}}}function mt(e,t){return{type:"picklist",expects:e.map(ge).join(" | "),async:!1,options:e,message:t,_parse(e,t){return this.options.includes(e)?pe(!0,e):ne(this,mt,e,t)}}}function he(e,t){const[n,r]=ve(e,t);return{type:"string",expects:"string",async:!1,message:n,pipe:r,_parse(e,t){return"string"==typeof e?de(this,e,t):ne(this,he,e,t)}}}function Nt(e){let t;if(e)for(const n of e)if(t)for(const e of n.issues)t.push(e);else t=n.issues;return t}function Re(e,t,n){const[r,o]=ve(t,n);return{type:"union",expects:[...new Set(e.map((e=>e.expects)))].join(" | "),async:!1,options:e,message:r,pipe:o,_parse(e,t){let n,r,o;for(const i of this.options){const a=i._parse(e,t);if(a.typed){if(!a.issues){n=a;break}o?o.push(a):o=[a]}else r?r.push(a):r=[a]}if(n)return de(this,n.output,t);if(null!=o&&o.length){const n=o[0];return de(this,n.output,t,1===o.length?n.issues:ne(this,Re,e,t,{reason:"union",issues:Nt(o)}).issues)}return 1===(null==r?void 0:r.length)?r[0]:ne(this,Re,e,t,{issues:Nt(r)})}}}function vt(e,t,n){const r=e._parse(t,bn(n));if(r.issues)throw new or(r.issues);return r.output}function Pn(e,t,n){const r=e._parse(t,bn(n));return{typed:r.typed,success:!r.issues,output:r.output,issues:r.issues}}function hr(e,t,n){return{...e,_parse(r,o){const i=e._parse(r,o);if(i.issues)i.typed=!1;else if(i.output=t(i.output,{issues:i.issues}),n)return Array.isArray(n)?de({type:typeof i.output,pipe:n},i.output,o):n._parse(i.output,o);return i}}}function $n(e,t){return{type:"max_length",expects:`<=${e}`,async:!1,message:t,requirement:e,_parse(e){return e.length<=this.requirement?Xe(e):Ve(this,$n,e,"length",`${e.length}`)}}}function Dn(e,t){return{type:"min_length",expects:`>=${e}`,async:!1,message:t,requirement:e,_parse(e){return e.length>=this.requirement?Xe(e):Ve(this,Dn,e,"length",`${e.length}`)}}}function Ge(e,t){return{type:"min_value",expects:`>=${e instanceof Date?e.toJSON():ge(e)}`,async:!1,message:t,requirement:e,_parse(e){return e>=this.requirement?Xe(e):Ve(this,Ge,e,"value",e instanceof Date?e.toJSON():ge(e))}}}function Cn(e,t){return{type:"regex",expects:`${e}`,async:!1,message:t,requirement:e,_parse(e){return this.requirement.test(e)?Xe(e):Ve(this,Cn,e,"format")}}}const z=96/25.4*devicePixelRatio,X=25.4/96/devicePixelRatio;async function Ht(e){await new Promise((t=>setTimeout(t,e)))}function lt(e){return e.map((e=>encodeURIComponent(String(e)))).join("/")}function pr(e){return e.split("/").map((e=>decodeURIComponent(e)))}function _r(e,t){return e.x<t.x+t.width&&e.x+e.width>t.x&&e.y<t.y+t.height&&e.y+e.height>t.y}function En(...e){return e.map((e=>void 0===e?"":"string"==typeof e?e:Object.entries(e).filter((([,e])=>e)).map((([e])=>e)))).join(" ")}function fr(e,t){const n=document.createElement("a");n.href=URL.createObjectURL(new Blob([t],{type:"application/octet-stream"})),n.download=e,n.click()}function yr(e){const t=window.open("","_blank");if(!t)throw new Error("Failed to open new tab.");t.document.write(e),t.document.close(),t.print(),t.close()}function mr(e,t){return ye((n=>e((e=>{const r=e[t],o="function"==typeof n?n(r):n;return{...e,[t]:o}}))),[t])}const Pe=Re([hr(We(""),(()=>crypto.randomUUID())),he([Cn(/^[0-9a-zA-Z_\-]+$/)])]),gt=De(he()),vr=_e({type:We("text"),id:Pe,x:I(),y:I(),width:I(),height:I(),fontSize:R(I(),16),text:R(he(),""),color:R(he(),"#000"),path:R(gt)}),gr=_e({type:We("table"),id:Pe,x:I(),y:I(),width:I(),height:I(),columns:De(I([Ge(0)])),rowHeight:I(),path:R(gt),padding:R(I(),0)}),xr=Re([vr,gr]),wr=_e({id:Pe,name:R(he([Dn(1),$n(100)]),""),x:I(),y:I(),z:R(I(),Number.MIN_SAFE_INTEGER),width:I(),height:I(),children:R(De(xr),[]),path:R(gt),sourceId:R(Pe,void 0),instanceIndex:R(I([Ge(0)]))}),Ot=I([Ge(0)]),xt=_e({id:Pe,name:R(he(),""),pages:De(wr),align:R(mt(["vertical","horizontal"]),"horizontal"),width:Ot,height:Ot});function br(e,t){return e.path?ct(e.path,t):e.text}function ct(e,t){const n=re(e,t);return void 0===n?`[ERR:${e.join("/")}]`:"string"==typeof n||"number"==typeof n||"boolean"==typeof n||null===n?String(n):Array.isArray(n)?`Array(${n.length})`:"object"==typeof n?`Object[${Object.keys(n).length}]`:`unexpected: ${n}`}function re(e,t){if(!e)return;let n=t;for(const r of e){if(void 0===n)break;if(null===n)return null;n="$instanceIndex"===r&&"number"==typeof t.$instanceIndex?n[t.$instanceIndex]:n[r]}return n}function Ft(e,t){return _r({x:0,y:0,width:t.width,height:t.height},{x:e.x,y:e.y,width:e.width,height:e.height})}function kr(e,t){const n=e.pages.map((e=>{if(e.children.find((e=>e.id==t))){const n=e.children.filter((e=>e.id!==t));return{...e,children:n}}return e}));return{...e,pages:n}}function Sr(e,t){for(const n of e.pages)for(const e of n.children)if(e.id===t)return e}function je(e,t){for(const n of e.pages){if(n.id===t)return{page:n,node:void 0};for(const e of n.children)if(e.id===t)return{page:n,node:e}}return{page:void 0,node:void 0}}function Rt(e,t,n){const{page:r,node:o}=je(e,t);if(r&&o&&!Ft(o,r)){for(const t of e.pages){const n={...o,x:o.x+r.x-t.x,y:o.y+r.y-t.y};if(Ft(n,t))return{...e,pages:e.pages.map((e=>e.id===t.id?{...e,children:[...e.children,n]}:e.id===r.id?{...e,children:e.children.filter((e=>e.id!==o.id))}:e))}}if(n)return kr(e,t)}}function Mn(e){let t=0;return{...e,pages:e.pages.map((e=>{const n={...e,x:t,y:0};return t+=n.width+20,n}))}}function An(e){let t=0;return{...e,pages:e.pages.map((e=>{const n={...e,x:0,y:t};return t+=n.height+30,n}))}}function Pr(e,t){for(var n in t)e[n]=t[n];return e}function ut(e,t){for(var n in e)if("__source"!==n&&!(n in t))return!0;for(var r in t)if("__source"!==r&&e[r]!==t[r])return!0;return!1}function jt(e,t){this.props=e,this.context=t}function K(e,t){function n(e){var n=this.props.ref,r=n==e.ref;return!r&&n&&(n.call?n(null):n.current=null),t?!t(this.props,e)||!r:ut(this.props,e)}function r(t){return this.shouldComponentUpdate=n,ke(e,t)}return r.displayName="Memo("+(e.displayName||e.name)+")",r.prototype.isReactComponent=!0,r.__f=!0,r}(jt.prototype=new Q).isPureReactComponent=!0,jt.prototype.shouldComponentUpdate=function(e,t){return ut(this.props,e)||ut(this.state,t)};var Ut=g.__b;g.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),Ut&&Ut(e)};var $r=g.__e;g.__e=function(e,t,n,r){if(e.then)for(var o,i=t;i=i.__;)if((o=i.__c)&&o.__c)return null==t.__e&&(t.__e=n.__e,t.__k=n.__k),o.__c(e,t);$r(e,t,n,r)};var zt=g.unmount;function Tn(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach((function(e){"function"==typeof e.__c&&e.__c()})),e.__c.__H=null),null!=(e=Pr({},e)).__c&&(e.__c.__P===n&&(e.__c.__P=t),e.__c=null),e.__k=e.__k&&e.__k.map((function(e){return Tn(e,t,n)}))),e}function In(e,t,n){return e&&n&&(e.__v=null,e.__k=e.__k&&e.__k.map((function(e){return In(e,t,n)})),e.__c&&e.__c.__P===t&&(e.__e&&n.appendChild(e.__e),e.__c.__e=!0,e.__c.__P=n)),e}function tt(){this.__u=0,this.t=null,this.__b=null}function Ln(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function Ee(){this.u=null,this.o=null}g.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&32&e.__u&&(e.type=null),zt&&zt(e)},(tt.prototype=new Q).__c=function(e,t){var n=t.__c,r=this;null==r.t&&(r.t=[]),r.t.push(n);var o=Ln(r.__v),i=!1,a=function(){i||(i=!0,n.__R=null,o?o(l):l())};n.__R=a;var l=function(){if(! --r.__u){if(r.state.__a){var e=r.state.__a;r.__v.__k[0]=In(e,e.__c.__P,e.__c.__O)}var t;for(r.setState({__a:r.__b=null});t=r.t.pop();)t.forceUpdate()}};r.__u++||32&t.__u||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(a,a)},tt.prototype.componentWillUnmount=function(){this.t=[]},tt.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=Tn(this.__b,n,r.__O=r.__P)}this.__b=null}var o=t.__a&&ke(D,null,e.fallback);return o&&(o.__u&=-33),[ke(D,null,t.__a?null:e.children),o]};var Bt=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};(Ee.prototype=new Q).__a=function(e){var t=this,n=Ln(t.__v),r=t.o.get(e);return r[0]++,function(o){var i=function(){t.props.revealOrder?(r.push(o),Bt(t,e,r)):o()};n?n(i):i()}},Ee.prototype.render=function(e){this.u=null,this.o=new Map;var t=Fe(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},Ee.prototype.componentDidUpdate=Ee.prototype.componentDidMount=function(){var e=this;this.o.forEach((function(t,n){Bt(e,n,t)}))};var Dr=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,Cr=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,Er=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,Mr=/[A-Z0-9]/g,Ar=typeof document<"u",Tr=function(e){return(typeof Symbol<"u"&&"symbol"==typeof Symbol()?/fil|che|rad/:/fil|che|ra/).test(e)};Q.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach((function(e){Object.defineProperty(Q.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})}));var Yt=g.event;function Ir(){}function Lr(){return this.cancelBubble}function Nr(){return this.defaultPrevented}g.event=function(e){return Yt&&(e=Yt(e)),e.persist=Ir,e.isPropagationStopped=Lr,e.isDefaultPrevented=Nr,e.nativeEvent=e};var Hr={enumerable:!1,configurable:!0,get:function(){return this.class}},Vt=g.vnode;g.vnode=function(e){"string"==typeof e.type&&function(e){var t=e.props,n=e.type,r={};for(var o in t){var i=t[o];if(!("value"===o&&"defaultValue"in t&&null==i||Ar&&"children"===o&&"noscript"===n||"class"===o||"className"===o)){var a=o.toLowerCase();"defaultValue"===o&&"value"in t&&null==t.value?o="value":"download"===o&&!0===i?i="":"translate"===a&&"no"===i?i=!1:"ondoubleclick"===a?o="ondblclick":"onchange"!==a||"input"!==n&&"textarea"!==n||Tr(t.type)?"onfocus"===a?o="onfocusin":"onblur"===a?o="onfocusout":Er.test(o)?o=a:-1===n.indexOf("-")&&Cr.test(o)?o=o.replace(Mr,"-$&").toLowerCase():null===i&&(i=void 0):a=o="oninput","oninput"===a&&r[o=a]&&(o="oninputCapture"),r[o]=i}}"select"==n&&r.multiple&&Array.isArray(r.value)&&(r.value=Fe(t.children).forEach((function(e){e.props.selected=-1!=r.value.indexOf(e.props.value)}))),"select"==n&&null!=r.defaultValue&&(r.value=Fe(t.children).forEach((function(e){e.props.selected=r.multiple?-1!=r.defaultValue.indexOf(e.props.value):r.defaultValue==e.props.value}))),t.class&&!t.className?(r.class=t.class,Object.defineProperty(r,"className",Hr)):(t.className&&!t.class||t.class&&t.className)&&(r.class=r.className=t.className),e.props=r}(e),e.$$typeof=Dr,Vt&&Vt(e)};var Xt=g.__r;g.__r=function(e){Xt&&Xt(e),e.__c};var Wt=g.diffed;g.diffed=function(e){Wt&&Wt(e);var t=e.props,n=e.__e;null!=n&&"textarea"===e.type&&"value"in t&&t.value!==n.value&&(n.value=null==t.value?"":t.value)};var Or=0;function a(e,t,n,r,o,i){var a,l,s={};for(l in t)"ref"==l?a=t[l]:s[l]=t[l];var c={type:e,props:s,key:n,ref:a,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:--Or,__i:-1,__u:0,__source:o,__self:i};if("function"==typeof e&&(a=e.defaultProps))for(l in a)void 0===s[l]&&(s[l]=a[l]);return g.vnode&&g.vnode(c),c}const W=100*z;function Fr(e){const{inverted:t}=e,n=new DOMPoint(0,0).matrixTransform(t),r=new DOMPoint(e.svgBounds.width,e.svgBounds.height).matrixTransform(t),o=Math.ceil((r.x-n.x)/W)+2,i=Math.ceil((r.y-n.y)/W)+2;return a("g",{transform:`translate(${Math.floor(n.x/(2*W))*(2*W)},${Math.floor(n.y/(2*W))*(2*W)})`,style:{pointerEvents:"none",userSelect:"none"},children:a(Rr,{countX:o,countY:i})})}const Rr=K((function(e){const{countX:t,countY:n}=e,r=[];for(let e=0;e<n;e++)for(let n=0;n<t;n++)(n+e)%2==0&&r.push(a("rect",{class:"background-grid-cell",x:W*n,y:W*e,width:W,height:W,style:{pointerEvents:"none",userSelect:"none"}}));return a("g",{children:r})})),jr=K((function(e){const{report:t,svgBounds:n,selectedId:r,shadowRoot:o}=e;return a("g",{children:t.pages.map((e=>e.children.map((e=>{if(e.path&&e.id===r)return a(Ur,{id:e.id,path:e.path,svgBounds:n,shadowRoot:o},e.id)}))))})}));function Ur(e){const{id:t,svgBounds:n,shadowRoot:r}=e,[o,i]=j(),[l,s]=j();if(Ye((()=>{const n=r??document,o=n.getElementById(lt(e.path));if(o){const e=n.getElementById(t);e instanceof Element&&(i(o),s(e))}}),[]),!o||!l)return a(D,{});const c=o.getBoundingClientRect(),u=l.getBoundingClientRect(),d=c.x+c.width-n.x,p=c.y+.5*c.height-n.y,h=u.x-n.x,_=u.y+.5*u.height-n.y,f=.5*Math.abs(h-d);return a(D,{children:[a("path",{d:["M",d,p,"C",d+f,p,h-f,_,h,_].join(" "),stroke:"dimdray","stroke-width":2,"stroke-dasharray":"5 5",fill:"transparent",opacity:.5,style:{pointerEvents:"none",userSelect:"none"}}),a("path",{d:["M",d,p,"C",d+f,p,h-f,_,h,_].join(" "),stroke:"grey","stroke-width":2,"stroke-dasharray":"5 5","stroke-dashoffset":"5",fill:"transparent",opacity:.5,style:{pointerEvents:"none",userSelect:"none"}}),a("circle",{cx:d,cy:p,r:8,fill:"dimgray"})]})}function zr(e){const{child:t,dataset:n}=e;switch(t.type){case"text":return a(Br,{child:t,dataset:n});case"table":return a(Yr,{child:t,dataset:n})}}function Br(e){const{child:t,dataset:n}=e,r=yt(),o=br(t,n);return a("g",{"data-node":t.id,"data-path":t.path,children:[a("text",{id:t.id,class:"node text",x:t.x+"mm",y:t.y+"mm","font-size":t.fontSize+"mm",fill:t.color,"alignment-baseline":"hanging",style:{userSelect:"none"},"clip-path":`url(#${r})`,children:o}),a("clipPath",{id:r,children:a("rect",{x:t.x+"mm",y:t.y+"mm",width:Math.max(0,t.width)+"mm",height:Math.max(0,t.height)+"mm",fill:"transparent"})})]})}function Yr(e){var t;const{child:n,dataset:r}=e,o=yt(),i=[];let l=0;const s=[];for(let e=0;e<n.columns.length;e++)l+=n.columns[e],s.push(l);const c=Math.floor(n.height/n.rowHeight),u=n.width,d=n.rowHeight*c;for(let e=0;e<s.length;e++){const t=s[e];i.push(a("line",{x1:n.x+t+"mm",y1:n.y,x2:n.x+t+"mm",y2:n.y+d+"mm",stroke:"red"}))}for(let e=0;e<c;e++){const t=n.rowHeight*e;i.push(a("line",{x1:n.x,y1:n.y+t+"mm",x2:n.x+u+"mm",y2:n.y+t+"mm",stroke:"blue"}))}const p=re(n.path,r),h=Array.isArray(p)?p.map((e=>null==e?[]:"object"==typeof e?Object.values(e).map((e=>String(e))):[])):[],_=[];for(let e=0;e<n.height/n.rowHeight;e++)for(let r=0;r<s.length;r++){const o=s[r],i=n.rowHeight*e,l=String((null==(t=h[e])?void 0:t[r])??"").slice(0,4);_.push(a("text",{x:n.x+o+n.padding+"mm",y:n.y+i+n.padding+"mm","font-size":"5mm",fill:"#111","alignment-baseline":"before-edge",style:{userSelect:"none"},children:l}))}return a("g",{class:"node table","clip-path":`url(#${o})`,children:[a("rect",{id:n.id,x:n.x+"mm",y:n.y+"mm",width:u+"mm",height:d+"mm",fill:"transparent",stroke:"#111"}),i,_,a("clipPath",{id:o,children:a("rect",{x:n.x+"mm",y:n.y+"mm",width:u+"mm",height:d+"mm",fill:"transparent"})})]})}function wt(e){const{selected:t,page:n,setPage:r,onPointerDown:o,onPointerUp:i,inverted:l,svgBounds:s,setSelectedId:c,transition:u}=e,d=yt(),p=re(n.path,e.dataset),h={...e.dataset,$pageData:p,$instanceIndex:n.instanceIndex};return a("g",{"data-page-id":n.id,class:"page-container"+(u?" transform-transition":""),transform:0===n.x&&0===n.y?void 0:`translate(${n.x*z},${n.y*z})`,children:[a("rect",{fill:"white",class:"page"+(t?" selected":""),width:n.width+"mm",height:n.height+"mm",onPointerDown:e=>{e.stopPropagation(),o(e)},onPointerUp:e=>{e.stopPropagation(),i(e)},onDragOver:e=>{e.preventDefault()},onDrop:e=>{var t;if(e.dataTransfer){const o=pr(null==(t=e.dataTransfer)?void 0:t.getData("text/plain")),i=e.clientX-s.x,a=e.clientY-s.y,u=new DOMPoint(i,a).matrixTransform(l),d={type:"text",id:crypto.randomUUID(),x:u.x*X-n.x,y:u.y*X-n.y,width:100,height:30,text:"Hello, World!",fontSize:30,path:o,color:"#aaa"};c(d.id),r({...n,children:[...n.children,d]})}}}),a("g",{"clip-path":`url(#${d})`,children:n.children.map((e=>a(zr,{child:e,dataset:h},e.id)))}),a("clipPath",{id:d,children:a("rect",{x:0,y:0,width:n.width*z,height:n.height*z})})]})}const Me=6;function Vr(e){const{x:t,y:n,onPointerDown:r,onPointerUp:o}=e;return a("rect",{class:"anchor",width:12,height:12,x:t-6,y:n-6,onPointerDown:e=>{e.stopPropagation(),null==r||r(e)},onPointerUp:e=>{e.stopPropagation(),null==o||o(e)}})}const Xr=K((function(e){const{pageX:t,pageY:n,matrix:r,node:o,selected:i,setSelectedId:l,setDragging:s}=e,c=new DOMPoint((t+o.x)*z,(n+o.y)*z).matrixTransform(r),u=new DOMPoint((t+o.x+Math.max(0,o.width))*z,(n+o.y+Math.max(0,o.height))*z).matrixTransform(r);return a("g",{"data-path":o.path,"data-node":o.id,children:[a("rect",{x:c.x,y:c.y,width:u.x-c.x,height:u.y-c.y,fill:"rgba(0,0,100,0.001)",onPointerDown:e=>{e.stopPropagation(),l(o.id),s({type:"drag-node",pointerDownX:e.clientX,pointerDownY:e.clientY,initial:o})}}),i&&a(D,{children:[a("rect",{x:c.x,y:c.y,width:u.x-c.x,height:u.y-c.y,fill:"rgba(100,0,0,0.01)",stroke:"black","stroke-width":"1","stroke-dasharray":"5 5",style:{pointerEvents:"none"}}),a("rect",{x:c.x,y:c.y,width:u.x-c.x,height:u.y-c.y,fill:"transparent",stroke:"white","stroke-width":"1","stroke-dasharray":"5 5","stroke-dashoffset":"5",style:{pointerEvents:"none"}}),a(Vr,{x:u.x,y:u.y,onPointerDown:e=>{s({type:"drag-node-right-bottom",pointerDownX:e.clientX,pointerDownY:e.clientY,initial:o})},onPointerUp:()=>{s(void 0)}})]})]})})),Wr=K((function(e){const{page:t,matrix:n,selected:r,setSelectedId:o,selectedId:i,setDragging:l}=e,{x:s,y:c,width:u,height:d}=t,p=new DOMPoint(s*z,c*z).matrixTransform(n),h=new DOMPoint((s+u)*z,(c+d)*z).matrixTransform(n);return a("g",{children:[a("text",{class:"page-id",x:p.x,y:h.y+4,"alignment-baseline":"text-before-edge",style:{pointerEvents:"none",userSelect:"none"},children:t.name??t.id}),t.children.map((e=>a(Xr,{pageX:t.x,pageY:t.y,matrix:n,node:e,selected:e.id===i,setSelectedId:o,setDragging:l},e.id))),r&&a(D,{children:[a("rect",{x:p.x,y:p.y,width:h.x-p.x,height:h.y-p.y,fill:"rgba(100,0,0,0.01)",stroke:"black","stroke-width":"2","stroke-dasharray":"5 5",style:{pointerEvents:"none"}}),a("rect",{x:p.x,y:p.y,width:h.x-p.x,height:h.y-p.y,fill:"rgba(100,0,0,0.01)",stroke:"white","stroke-width":"2","stroke-dasharray":"5 5","stroke-dashoffset":"5",style:{pointerEvents:"none"}})]})]})})),Nn=-5,Hn=3;function Gr(e){const{view:t,dataset:n,setReport:r,selectedId:o,setSelectedId:i,onViewportUpdated:l,generation:s,setGeneration:c,svgBounds:u,transition:d,shadowRoot:p,report:h,evaluated:_}=e,[f,g]=j(),y=ce((()=>Zr(t)),[t]),v=ce((()=>y.inverse()),[y]),[m,x]=j(new DOMPoint(0,0)),w=m.matrixTransform(v),b=Math.pow(2,t.scaleFactor),k=gn(null),S=ce((()=>[..._.pages].sort(((e,t)=>e.z-t.z))),[_.pages]);return Ye((()=>{const e=k.current;if(!e)return;const t=e=>{e.preventDefault(),l((t=>On(t,u,t.scaleFactor-.002*e.deltaY,e.clientX-u.x,e.clientY-u.y))),setTimeout((()=>c((e=>e+1))),10)};return e.addEventListener("wheel",t,{passive:!1}),()=>{e.removeEventListener("wheel",t)}}),[u]),a("svg",{id:"svg",ref:k,style:{width:"100%",height:"100%"},draggable:!1,onPointerDown:e=>{g({type:"drag-viewport",intiial:t,pointerDownX:e.clientX,pointerDownY:e.clientY})},onPointerMove:e=>{if(u&&x(new DOMPoint(e.clientX-u.x,e.clientY-u.y)),f)switch(f.type){case"drag-viewport":l({dx:f.intiial.dx+e.clientX-f.pointerDownX,dy:f.intiial.dy+e.clientY-f.pointerDownY,scaleFactor:t.scaleFactor});break;case"drag-page":r({...h,pages:h.pages.map((t=>{const n=f.initial.x+(e.clientX-f.pointerDownX)*X/b,r=f.initial.y+(e.clientY-f.pointerDownY)*X/b;return t.id===f.initial.id?{...t,x:n,y:r}:t}))});break;case"drag-node":r((t=>{const n={...t,pages:t.pages.map((t=>{if(t.children.find((e=>e.id===f.initial.id))){const n=t.children.map((t=>{if(t.id!==f.initial.id)return t;const n=f.initial.x+(e.clientX-f.pointerDownX)*X/b,r=f.initial.y+(e.clientY-f.pointerDownY)*X/b;return{...t,x:n,y:r}}));return{...t,children:n}}return t}))},r=Rt(n,f.initial.id,!1);if(r){const t=Sr(r,f.initial.id);return t&&g({type:"drag-node",initial:t,pointerDownX:e.clientX,pointerDownY:e.clientY}),r}return n}));break;case"drag-node-right-bottom":r({...h,pages:h.pages.map((t=>t.children.find((e=>e.id===f.initial.id))?{...t,children:t.children.map((t=>{const n=Math.max(0,f.initial.width+(e.clientX-f.pointerDownX)*X/b),r=Math.max(0,f.initial.height+(e.clientY-f.pointerDownY)*X/b);return t.id===f.initial.id?{...t,width:n,height:r}:t}))}:t))})}},onPointerUp:()=>{"drag-node"===(null==f?void 0:f.type)&&r((e=>{const t=Rt(e,f.initial.id,!0);return t?(i(void 0),[`dropNode ${f.initial.id}`,t]):[`moveNode ${f.initial.id}`,e]})),g(void 0)},children:[a("g",{transform:y.toString(),children:a(Fr,{inverted:v,svgBounds:u})}),S.map(((e,t)=>a(D,{children:[a("g",{transform:y.toString(),children:a(wt,{selected:e.id===o,page:e,setPage:e=>r({...h,pages:h.pages.map((t=>t.id==e.id?e:t))}),dataset:{...n,$pageIndex:t,$pageId:e.id},onPointerDown:t=>{i(e.id),g({type:"drag-page",initial:e,pointerDownX:t.clientX,pointerDownY:t.clientY})},onPointerUp:()=>g(void 0),inverted:v,svgBounds:u,setSelectedId:i,transition:d},e.id)}),e.id===e.sourceId&&a(Wr,{page:e,matrix:y,selected:e.id===o,setSelectedId:i,selectedId:o,setDragging:g},e.id)]}))),a("g",{children:[a("text",{x:"10",y:"25",class:"coords",children:["x: ",(w.x*X).toFixed(1).padStart(6," "),"mm"]}),a("text",{x:"10",y:"45",class:"coords",children:["y: ",(w.y*X).toFixed(1).padStart(6," "),"mm"]})]}),o&&a(jr,{report:h,svgBounds:u,generation:s,selectedId:o,shadowRoot:p})]})}function Zr(e){const t=Math.pow(2,e.scaleFactor),n=new DOMMatrix;return n.translateSelf(e.dx,e.dy),n.scaleSelf(t),n}function Gt(e){return Math.pow(2,e)}function Jr(e){return Math.max(Nn,Math.min(Hn,e))}function On(e,t,n,r,o){const i=Gt(e.scaleFactor),a=Jr(n),l=e.dx,s=e.dy,c=r??.5*t.width,u=o??.5*t.height,d=Gt(a);return{scaleFactor:a,dx:(i-d)*(c-l)/i+l,dy:(i-d)*(u-s)/i+s}}function qr(e){const{view:t,setView:n,svgBounds:r}=e;return a("div",{style:{position:"absolute",bottom:0,right:0,padding:"10px",display:"flex",alignItems:"center",gap:"0.2em"},children:[a("span",{children:t.scaleFactor.toFixed(1)}),a("input",{type:"range",min:Nn,value:t.scaleFactor,max:Hn,step:.1,onChange:e=>n((t=>On(t,r,e.currentTarget.valueAsNumber,.5*r.width,.5*r.height)))})]})}var Zt=/[\s\n\\/='"\0<>]/,Jt=/^(xlink|xmlns|xml)([A-Z])/,Qr=/^accessK|^auto[A-Z]|^ch|^col|cont|cross|dateT|encT|form[A-Z]|frame|hrefL|inputM|maxL|minL|noV|playsI|readO|rowS|spellC|src[A-Z]|tabI|item[A-Z]/,Kr=/^ac|^ali|arabic|basel|cap|clipPath$|clipRule$|color|dominant|enable|fill|flood|font|glyph[^R]|horiz|image|letter|lighting|marker[^WUH]|overline|panose|pointe|paint|rendering|shape|stop|strikethrough|stroke|text[^L]|transform|underline|unicode|units|^v[^i]|^w|^xH/,eo=/["&<]/;function Ae(e){if(0===e.length||!1===eo.test(e))return e;for(var t=0,n=0,r="",o="";n<e.length;n++){switch(e.charCodeAt(n)){case 34:o="&quot;";break;case 38:o="&amp;";break;case 60:o="&lt;";break;default:continue}n!==t&&(r+=e.slice(t,n)),r+=o,t=n+1}return n!==t&&(r+=e.slice(t,n)),r}var qt={},to=new Set(["animation-iteration-count","border-image-outset","border-image-slice","border-image-width","box-flex","box-flex-group","box-ordinal-group","column-count","fill-opacity","flex","flex-grow","flex-negative","flex-order","flex-positive","flex-shrink","flood-opacity","font-weight","grid-column","grid-row","line-clamp","line-height","opacity","order","orphans","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-miterlimit","stroke-opacity","stroke-width","tab-size","widows","z-index","zoom"]),no=/[A-Z]/g;function ro(e){var t="";for(var n in e){var r=e[n];if(null!=r&&""!==r){var o="-"==n[0]?n:qt[n]||(qt[n]=n.replace(no,"-$&").toLowerCase()),i=";";"number"!=typeof r||o.startsWith("--")||to.has(o)||(i="px;"),t=t+o+":"+r+i}}return t||void 0}function U(e,t,n){if(!e.s){if(n instanceof bt){if(!n.s)return void(n.o=U.bind(null,e,t));1&t&&(t=n.s),n=n.v}if(n&&n.then)return void n.then(U.bind(null,e,t),U.bind(null,e,2));e.s=t,e.v=n;const r=e.o;r&&r(e)}}var bt=function(){function e(){}return e.prototype.then=function(t,n){var r=new e,o=this.s;if(o){var i=1&o?t:n;if(i){try{U(r,1,i(this.v))}catch(e){U(r,2,e)}return r}return this}return this.o=function(e){try{var o=e.v;1&e.s?U(r,1,t?t(o):o):n?U(r,1,n(o)):U(r,2,o)}catch(e){U(r,2,e)}},r},e}();function fe(e){return e instanceof bt&&1&e.s}function oo(e,t,n){for(var r;;){var o=e();if(fe(o)&&(o=o.v),!o)return i;if(o.then){r=0;break}var i=n();if(i&&i.then){if(!fe(i)){r=1;break}i=i.s}if(t){var a=t();if(a&&a.then&&!fe(a)){r=2;break}}}var l=new bt,s=U.bind(null,l,2);return(0===r?o.then(u):1===r?i.then(c):a.then(d)).then(void 0,s),l;function c(r){i=r;do{if(t&&(a=t())&&a.then&&!fe(a))return void a.then(d).then(void 0,s);if(!(o=e())||fe(o)&&!o.v)return void U(l,1,i);if(o.then)return void o.then(u).then(void 0,s);fe(i=n())&&(i=i.v)}while(!i||!i.then);i.then(c).then(void 0,s)}function u(e){e?(i=n())&&i.then?i.then(c).then(void 0,s):c(i):U(l,1,i)}function d(){(o=e())?o.then?o.then(u).then(void 0,s):u(o):U(l,1,i)}}function io(e,t){try{var n=e()}catch(e){return t(!0,e)}return n&&n.then?n.then(t.bind(null,!1),t.bind(null,!0)):t(!1,n)}var dt,ae,$e,se,Fn=function(e,t){try{var n,r=g.__s;g.__s=!0,dt=g.__b,ae=g.diffed,$e=g.__r,se=g.unmount;var o=ke(D,null);return o.__k=[e],Promise.resolve(io((function(){var r=q(e,t||Rn,!1,void 0,o,!0),i=function(){if(Array.isArray(r)){var e=function(){var e=o.join("");return n=1,e},t=0,o=r,i=oo((function(){return!!o.some((function(e){return"function"==typeof e.then}))&&t++<25}),void 0,(function(){return Promise.resolve(Promise.all(o)).then((function(e){o=e.flat()}))}));return i&&i.then?i.then(e):e()}}();return i&&i.then?i.then((function(e){return n?e:r})):n?i:r}),(function(t,n){if(g.__c&&g.__c(e,Qt),g.__s=r,Qt.length=0,t)throw n;return n})))}catch(e){return Promise.reject(e)}},Qt=[],Kt=Array.isArray,ht=Object.assign;function en(){this.__d=!0}var Rn={};function tn(e,t){var n,r=e.type,o=!0;return e.__c?(o=!1,(n=e.__c).state=n.__s):n=new r(e.props,t),e.__c=n,n.__v=e,n.props=e.props,n.context=t,n.__d=!0,null==n.state&&(n.state=Rn),null==n.__s&&(n.__s=n.state),r.getDerivedStateFromProps?n.state=ht({},n.state,r.getDerivedStateFromProps(n.props,n.state)):o&&n.componentWillMount?(n.componentWillMount(),n.state=n.__s!==n.state?n.__s:n.state):!o&&n.componentWillUpdate&&n.componentWillUpdate(),$e&&$e(e),n.render(n.props,n.state,t)}function q(e,t,n,r,o,i){if(null==e||!0===e||!1===e||""===e)return"";if("object"!=typeof e)return"function"==typeof e?"":Ae(e+"");if(Kt(e)){var a,l="";o.__k=e;for(var s=0;s<e.length;s++){var c=e[s];if(null!=c&&"boolean"!=typeof c){var u,d=q(c,t,n,r,o,i);"string"==typeof d?l+=d:(a=a||[],l&&a.push(l),l="",Array.isArray(d)?(u=a).push.apply(u,d):a.push(d))}}return a?(l&&a.push(l),a):l}if(void 0!==e.constructor)return"";e.__=o,dt&&dt(e);var p,h,_,f=e.type,y=e.props,v=t;if("function"==typeof f){if(f===D){if(y.tpl){for(var m="",x=0;x<y.tpl.length;x++)if(m+=y.tpl[x],y.exprs&&x<y.exprs.length){var w=y.exprs[x];if(null==w)continue;"object"!=typeof w||void 0!==w.constructor&&!Kt(w)?m+=w:m+=q(w,t,n,r,e,i)}return m}if(y.UNSTABLE_comment)return"\x3c!--"+Ae(y.UNSTABLE_comment||"")+"--\x3e";h=y.children}else{if(null!=(p=f.contextType)){var b=t[p.__c];v=b?b.props.value:p.__}if(f.prototype&&"function"==typeof f.prototype.render)h=tn(e,v),_=e.__c;else{e.__c=_={__v:e,props:y,context:v,setState:en,forceUpdate:en,__d:!0,__h:[]};for(var k=0;_.__d&&k++<25;)_.__d=!1,$e&&$e(e),h=f.call(_,y,v);_.__d=!0}if(null!=_.getChildContext&&(t=ht({},t,_.getChildContext())),(f.getDerivedStateFromError||_.componentDidCatch)&&g.errorBoundaries){var S="";h=null!=h&&h.type===D&&null==h.key?h.props.children:h;try{return S=q(h,t,n,r,e,i)}catch(o){return f.getDerivedStateFromError&&(_.__s=f.getDerivedStateFromError(o)),_.componentDidCatch&&_.componentDidCatch(o,{}),_.__d&&(h=tn(e,t),null!=(_=e.__c).getChildContext&&(t=ht({},t,_.getChildContext())),S=q(h=null!=h&&h.type===D&&null==h.key?h.props.children:h,t,n,r,e,i)),S}finally{ae&&ae(e),e.__=null,se&&se(e)}}}h=null!=h&&h.type===D&&null==h.key&&null==h.props.tpl?h.props.children:h;try{var P=q(h,t,n,r,e,i);return ae&&ae(e),e.__=null,se&&se(e),P}catch(o){if(!i||!o||"function"!=typeof o.then)throw o;var M=function o(){try{return q(h,t,n,r,e,i)}catch(a){if(!a||"function"!=typeof a.then)throw a;return a.then((function(){return q(h,t,n,r,e,i)}),(function(){return o()}))}};return o.then((function(){return M()}))}}var C,E="<"+f,I="";for(var T in y){var U=y[T];switch(T){case"children":C=U;continue;case"key":case"ref":case"__self":case"__source":continue;case"htmlFor":if("for"in y)continue;T="for";break;case"className":if("class"in y)continue;T="class";break;case"defaultChecked":T="checked";break;case"defaultSelected":T="selected";break;case"defaultValue":case"value":switch(T="value",f){case"textarea":C=U;continue;case"select":r=U;continue;case"option":r!=U||"selected"in y||(E+=" selected")}break;case"dangerouslySetInnerHTML":I=U&&U.__html;continue;case"style":"object"==typeof U&&(U=ro(U));break;case"acceptCharset":T="accept-charset";break;case"httpEquiv":T="http-equiv";break;default:if(Jt.test(T))T=T.replace(Jt,"$1:$2").toLowerCase();else{if(Zt.test(T))continue;"-"!==T[4]&&"draggable"!==T||null==U?n?Kr.test(T)&&(T="panose1"===T?"panose-1":T.replace(/([A-Z])/g,"-$1").toLowerCase()):Qr.test(T)&&(T=T.toLowerCase()):U+=""}}null!=U&&!1!==U&&"function"!=typeof U&&(E=!0===U||""===U?E+" "+T:E+" "+T+'="'+Ae(U+"")+'"')}if(Zt.test(f))throw new Error(f+" is not a valid HTML tag name in "+E+">");if(I||("string"==typeof C?I=Ae(C):null!=C&&!1!==C&&!0!==C&&(I=q(C,t,"svg"===f||"foreignObject"!==f&&n,r,e,i))),ae&&ae(e),e.__=null,se&&se(e),!I&&ao.has(f))return E+"/>";var $="</"+f+">",j=E+">";return Array.isArray(I)?[j].concat(I,[$]):"string"!=typeof I?[j,I,$]:j+I+$}var ao=new Set(["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"]);async function so(e,t,n){const r=document.createElementNS("http://www.w3.org/2000/svg","svg");if(r.setAttribute("xmlns","http://www.w3.org/2000/svg"),r.setAttribute("width",e.width+"mm"),r.setAttribute("height",e.height+"mm"),r.setAttribute("fill","white"),r.style.backgroundColor="black",r.innerHTML=await Fn(a(wt,{selected:!1,page:{...e,x:0,y:0},setPage:()=>{},dataset:{...n,$pageIndex:t,$pageId:e.id},onPointerDown:()=>{},onPointerUp:()=>{},inverted:new DOMMatrix,svgBounds:new DOMRect,setSelectedId:()=>{},transition:!1})),!(r instanceof SVGSVGElement))throw new Error("Expected SVGElement");return r}async function nn(e,t){const{pages:n}=e,r=[];for(let e=0;e<n.length;e++){const o=n[e];r.push(a("svg",{width:o.width+"mm",height:o.height+"mm",children:a(wt,{selected:!1,page:{...o,x:0,y:0},setPage:()=>{},dataset:{...t,$pageIndex:e,$pageId:o.id},onPointerDown:()=>{},onPointerUp:()=>{},inverted:new DOMMatrix,svgBounds:new DOMRect,setSelectedId:()=>{},transition:!1})}))}return"<!DOCTYPE html>\n"+await Fn(a("html",{children:[a("head",{children:a("style",{children:"\n@page {\n  margin: 0;\n  padding: 0;\n}\nbody {\n  background-color: black;\n}\nsvg {\n  display: block;\n}\n  "})}),a("body",{children:r})]}))}async function lo(e){const t=await fetch("https://svg-to-pdf-nnurw5pm5q-an.a.run.app",{method:"POST",body:e,headers:new Headers({Authorization:"Basic "+btoa("admin:tanuki")})});if(!t.ok)return void console.error("error",t);const n=await t.blob(),r=URL.createObjectURL(n),o=document.createElement("a");o.href=r,o.download="example.pdf",o.click(),URL.revokeObjectURL(r)}function J(e){return a("button",{...e,class:"icon-button"})}function co(e){const{report:t,dataset:n,setReport:r,setTransition:o,onReportSaved:i,selectedId:l}=e;return a("div",{style:{position:"absolute",top:0,right:0,padding:"10px",display:"flex",alignItems:"center",gap:"0.2em"},children:[a(J,{onClick:async()=>{r((e=>({...e,pages:e.pages.filter((e=>e.id!==l)).map((e=>({...e,children:e.children.filter((e=>e.id!==l))})))})))},children:"Delete"}),a(J,{onClick:async()=>{i&&i(t)},children:[a("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"lucide lucide-file-text",children:[a("path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"}),a("path",{d:"M14 2v4a2 2 0 0 0 2 2h4"}),a("path",{d:"M10 9H8"}),a("path",{d:"M16 13H8"}),a("path",{d:"M16 17H8"})]}),"Save"]}),a(J,{onClick:async()=>{r("undo")},children:[a("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"lucide lucide-corner-up-left",children:[a("polyline",{points:"9 14 4 9 9 4"}),a("path",{d:"M20 20v-7a4 4 0 0 0-4-4H4"})]}),"Undo"]}),a(J,{onClick:async()=>{r("redo")},children:[a("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"lucide lucide-corner-up-right",children:[a("polyline",{points:"15 14 20 9 15 4"}),a("path",{d:"M4 20v-7a4 4 0 0 1 4-4h12"})]}),"Redo"]}),a(J,{onClick:async()=>{o(!0),r(Mn),await Ht(300),o(!1)},children:[a("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"lucide lucide-align-horizontal-justify-start",children:[a("rect",{width:"6",height:"14",x:"6",y:"5",rx:"2"}),a("rect",{width:"6",height:"10",x:"16",y:"7",rx:"2"}),a("path",{d:"M2 2v20"})]}),"H"]}),a(J,{onClick:async()=>{o(!0),r(An),await Ht(300),o(!1)},children:[a("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"lucide lucide-align-start-vertical",children:[a("rect",{width:"9",height:"6",x:"6",y:"14",rx:"2"}),a("rect",{width:"16",height:"6",x:"6",y:"4",rx:"2"}),a("path",{d:"M2 2v20"})]}),"V"]}),a(J,{onClick:async()=>{const{page:e}=je(t,l);if(e){fr("export.svg",(await so(e,t.pages.indexOf(e),n)).outerHTML)}},children:[a("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"lucide lucide-file-text",children:[a("path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"}),a("path",{d:"M14 2v4a2 2 0 0 0 2 2h4"}),a("path",{d:"M10 9H8"}),a("path",{d:"M16 13H8"}),a("path",{d:"M16 17H8"})]}),"SVG"]}),a(J,{onClick:async()=>{const e=await nn(t,n);await lo(e)},children:[a("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"lucide lucide-file-text",children:[a("path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"}),a("path",{d:"M14 2v4a2 2 0 0 0 2 2h4"}),a("path",{d:"M10 9H8"}),a("path",{d:"M16 13H8"}),a("path",{d:"M16 17H8"})]}),"PDF"]}),a(J,{onClick:async()=>{yr(await nn(t,n))},children:[a("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"lucide lucide-file-text",children:[a("path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"}),a("path",{d:"M14 2v4a2 2 0 0 0 2 2h4"}),a("path",{d:"M10 9H8"}),a("path",{d:"M16 13H8"}),a("path",{d:"M16 17H8"})]}),"Print"]})]})}function rn(e){const{class:t,active:n,...r}=e;return a("button",{class:En("tab",t,{active:n}),...r})}function uo(e){const{class:t,...n}=e;return a("div",{class:En("tabs",t),...n})}const nt=K((function(e){const{datalist:t,onScroll:n}=e;return a("div",{class:"component-data-preview",onScroll:()=>n(),style:{height:"100vh",borderBottom:"solid white 1px"},children:a(ho,{path:[],node:t,depth:0})})})),ho=K((function e(t){const{path:n,node:r,depth:o}=t;if(void 0===r)return a(D,{});if(null===r)return a(ie,{path:n,depth:o,children:"null"});if("number"==typeof r)return a(ie,{path:n,depth:o,children:r});if("string"==typeof r)return a(ie,{path:n,depth:o,children:r});if("boolean"==typeof r)return a(ie,{path:n,depth:o,children:r});if(Array.isArray(r))return a(D,{children:r.map(((t,r)=>a(D,{children:[a(ie,{path:[...n,r],depth:o,children:[a("span",{class:"key",children:r}),a("span",{class:"value",children:on(t)})]}),("object"==typeof t&&null!=t||Array.isArray(t))&&a(e,{path:[...n,r],node:t,depth:o+1})]})))});if("object"==typeof r){return a(D,{children:Object.entries(r).map((([t,r])=>a(D,{children:[a(ie,{path:[...n,t],depth:o,children:[a("span",{class:"key",children:t}),a("span",{class:"value",children:on(r)})]}),(null!==typeof r&&"object"==typeof r||Array.isArray(r))&&a(e,{path:[...n,t],node:r,depth:o+1})]})))})}return a(ie,{path:n,depth:o,children:"unknown"})}));function on(e){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e||null===e?String(e):Array.isArray(e)?`array[${e.length}]`:"object"==typeof e?`object{${Object.keys(e).length}}`:"<<unknown>>"}const ie=K((function(e){const{path:t,depth:n,children:r}=e,o=lt(t);return a("div",{class:"row",style:{paddingLeft:`${.5+n}em`,display:"flex",userSelect:"none"},id:lt(t),draggable:!0,onDragStart:e=>{e.dataTransfer&&e.dataTransfer.setData("text/plain",o)},children:r},o)}));function po(e){const{dataset:t,onScroll:n,page:r,node:o}=e,i=null!=r&&r.path?re(r.path,t):void 0,l=null!=o&&o.path?re(o.path,t):void 0;return a("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[a(nt,{datalist:t,onScroll:n}),i&&a(nt,{datalist:i,onScroll:n}),l&&a(nt,{datalist:l,onScroll:n})]})}function _o(e){const{value:t,onChange:n}=e;return a("input",{type:"color",value:t,onChange:e=>n(e.currentTarget.value)})}function we(e){const{onChange:t,min:n,max:r}=e,[o,i]=j(e.value.toFixed());return Ye((()=>{i(e.value.toFixed())}),[e.value]),a("input",{type:"text",class:"number",value:o,style:{width:"100%","text-align":"right"},onChange:e=>{i(e.currentTarget.value);const o=parseFloat(e.currentTarget.value);Number.isFinite(o)&&t(Math.min(void 0===r?Number.POSITIVE_INFINITY:r,Math.max(void 0===n?Number.NEGATIVE_INFINITY:n,o)))},onFocus:e=>{e.currentTarget.select()},onBlur:()=>{i(e.value.toFixed())}})}function an(e){const{value:t,onChange:n}=e;return a("input",{type:"text",class:"text",value:t,style:{width:"100%"},onChange:e=>n(e.currentTarget.value),onFocus:e=>e.currentTarget.select()})}function sn(e){return a("table",{...e,style:{borderCollapse:"collapse",marginTop:"1em",width:"100%"}})}function ln(e){return a("td",{...e,style:{border:"solid 1px rgba(0,0,0,0.2)"}})}const fo=K((function(e){const{page:t,setPage:n,node:r,setNode:o,dataset:i}=e,l=null!=t&&t.path?re(t.path,i):void 0,s=re(null==r?void 0:r.path,{...i,$pageData:l,$instanceIndex:0}),c=null!=r&&r.path?ct(r.path,{...i,$pageData:l,$instanceIndex:0,$nodeData:s}):"";return a("div",{style:{padding:"8px"},children:[t&&n&&a(D,{children:[a("h3",{children:"ページ"}),a(sn,{children:a("tbody",{children:[a(F,{name:"Name",children:a(an,{value:t.name,onChange:e=>n((t=>({...t,name:e})))})}),a(F,{name:"Path",children:a(an,{value:t.path?t.path.join("/"):"",onChange:()=>{}})}),a(F,{name:"Data",children:a("div",{children:t.path?ct(t.path,i):""})}),a(F,{name:"Value",children:a("div",{style:{whiteSpace:"nowrap"},children:JSON.stringify(l).slice(0,100)})})]})})]}),r&&o&&a(D,{children:[a("h3",{children:"ノード"}),a(sn,{children:a("tbody",{children:[a(F,{name:"Type",children:r.type}),a(F,{name:"X",children:a(we,{value:r.x,onChange:e=>o((t=>({...t,x:e})))})}),a(F,{name:"Y",children:a(we,{value:r.y,onChange:e=>o((t=>({...t,y:e})))})}),a(F,{name:"Width",children:a(we,{value:r.width,onChange:e=>o((t=>({...t,width:e}))),min:0})}),a(F,{name:"Height",children:a(we,{value:r.height,onChange:e=>o((t=>({...t,height:e}))),min:0})}),"text"===r.type&&a(D,{children:[a(F,{name:"Text",children:a("textarea",{value:r.text,onChange:e=>o((t=>({...t,text:e.currentTarget.value})))})}),a(F,{name:"Font Size",children:a(we,{value:r.fontSize,min:1,max:1e3,onChange:e=>o((t=>({...t,fontSize:e})))})}),a(F,{name:"Path",children:r.path?r.path.join("/"):""}),a(F,{name:"Value",children:c}),a(F,{name:"Color",children:a(_o,{value:r.color,onChange:e=>o((t=>({...t,color:e})))})})]})]})})]})]})})),F=K((function(e){const{name:t,children:n}=e;return a("tr",{children:[a(ln,{children:a("span",{style:{whiteSpace:"nowrap"},children:t})}),a(ln,{children:n})]})}));function yo(e){const{dataset:t,onScroll:n,leftTab:r,setLeftTab:o,page:i,node:l,setNode:s,setPage:c}=e;return a("div",{class:"left-panel",style:{display:"flex",height:"100vh"},children:[a(uo,{children:[a(rn,{active:"data"===r,onClick:()=>o("data"),children:"Data"}),a(rn,{active:"props"==r,onClick:()=>o("props"),children:"Props"})]}),a("div",{style:{display:"data"===r?void 0:"none",height:"100px",flexGrow:1,flexShrink:1},children:a(po,{dataset:t,onScroll:n,page:i,node:l})}),a("div",{style:{display:"props"===r?void 0:"none",height:"100px",flexGrow:1,flexShrink:1},children:a(fo,{page:i,setPage:c,node:l,setNode:s,dataset:t})})]})}function mo(e){const{setData:t}=e;return a("div",{style:{display:"none",backgroundColor:"#888",flexShrink:"0",flexGrow:"0",padding:"0.5em",flexDirection:"column",gap:"0.5em"},children:[a("div",{}),a("div",{children:a("input",{type:"file",onChange:async e=>{var n,r;const o=null==(r=null==(n=e.currentTarget)?void 0:n.files)?void 0:r[0];if(o){const e=await o.text();t(JSON.parse(e))}}})})]})}function vo(e,t){let n=0;const r=[];for(const o of e.pages){o.path||r.push(o);const e=re(o.path,t);if(Array.isArray(e)){const t=e.map(((e,t)=>({...o,id:0===t?o.id:o.id+"///"+t,sourceId:o.id,instanceIndex:t,x:0===t?o.x:(10+o.width)*t,y:0===t?o.y:n,children:o.children.map(((e,n)=>0===t?e:{...e,id:0===t?e.id:e.id+"///"+n}))})));r.push(...t)}else r.push(o);n+=o.height+40}return{...e,pages:r}}const Ne=Pn(xt,{id:"",name:"My Report",width:210,height:297,align:"horizontal",pages:[{id:"",name:"4ページ",x:240,y:30,z:0,width:210,height:297,path:["data","pages","0","children","0","columns"],children:[{id:"",type:"text",x:10,y:10,width:160,height:100,path:["$pageData","$instanceIndex"],text:"",fontSize:60,color:"#000000"},{id:"",type:"text",x:10,y:100,width:160,height:200,path:void 0,text:"hogehoge",fontSize:60,color:"#000000"}]}]});if(!Ne.success){for(const e of Ne.issues)console.error(e);throw new Error(Ne.issues.map((e=>e.message)).join("\n"))}const go=An(Ne.output),He=Pn(xt,{id:"",name:"My Report",width:210,height:297,align:"horizontal",pages:[{id:"",name:"4ページ",x:240,y:30,z:0,width:210,height:297,children:[{id:"",type:"table",x:10,y:10,width:160,height:200,columns:[15,20,30],rowHeight:20,path:["data","pages"],padding:1}]},{id:"",name:"1ページ",x:0,y:0,z:0,width:210,height:297,children:[{id:"",type:"text",x:10,y:10,width:100,height:30,text:"Hello, World!",fontSize:30,color:"#ff0000"}]},{id:"",name:"2ページ",x:200,y:200,z:0,width:210,height:297,children:[{id:"",type:"text",x:0,y:0,width:210,height:20,text:"こんにちは、世界。",color:"#000000",fontSize:20},{id:"",type:"text",x:0,y:100,width:210,height:20,fontSize:20,color:"#999999",text:"",path:["data","pages","1","children","0","text"]}]},{id:"",name:"3ページ",x:500,y:100,z:0,width:210,height:297,children:[{id:"",type:"text",x:10,y:10,width:100,height:30,fontSize:30,color:"#0000ff",text:"",path:["data","pages","0","id"]}]}]});if(!He.success){for(const e of He.issues)console.error(e);throw new Error(He.issues.map((e=>e.message)).join("\n"))}const xo=Mn(He.output),jn=mt(["data","props"]);_e({tab:Sn(jn,"data")});const Un=_e({tab:Sn(jn,"data")});function wo(){const e=localStorage.getItem("localState")??"{}";return vt(Un,JSON.parse(e))}function bo(e){localStorage.setItem("localState",JSON.stringify(vt(Un,e)))}function ko(){const[e,t]=j(wo);return[e,e=>{t((t=>{const n="function"==typeof e?e(t):e;return bo(n),n}))}]}function So(e){return{undoList:[],action:"initialize",current:e,redoList:[]}}function Po(e,t){const{action:n,current:r}=e,o=t instanceof Function?t(r):t;if("undo"===o)return 0===e.undoList.length?e:{undoList:e.undoList.slice(1),action:e.undoList[0][0],current:e.undoList[0][1],redoList:[[n,r],...e.redoList]};if("redo"===o)return 0===e.redoList.length?e:{undoList:[[n,r],...e.undoList],action:e.redoList[0][0],current:e.redoList[0][1],redoList:e.redoList.slice(1)};if(Array.isArray(o)){const[t,n]=o;return{undoList:e.undoList,action:t,current:n,redoList:[]}}return""===e.action?{undoList:e.undoList,action:n,current:o,redoList:[]}:{undoList:[[n,r],...e.undoList],action:"",current:o,redoList:[]}}const $o=go,cn=xo;function Do(e){const{shadowRoot:t,source:n,onReportSaved:r}=e,[o,i]=ko(),l=o.tab,s=mr(i,"tab"),[c,u]=j({scaleFactor:-2,dx:100,dy:100}),[d,p]=j(),[h,_]=j(So($o)),[f,g]=j((()=>{if(!n)return cn;try{return vt(xt,JSON.parse(n))}catch(e){return console.error(e),cn}})),[y,v]=j(0),m=h.current,{page:x,node:w}=je(m,d),b=ye((e=>{d&&S((t=>({...t,pages:t.pages.map((t=>t.children.find((e=>e.id===d))?{...t,children:t.children.map((t=>t.id===d?e(t):t))}:t))})))}),[d]),k=ye((e=>{d&&S((t=>({...t,pages:t.pages.map((t=>t.id===d?e(t):t))})))}),[d]),S=ye((e=>{_((t=>Po(t,e)))}),[]),D=ye((e=>{S((t=>{const n=t.pages.reduce(((e,t)=>Math.max(e,t.z)),0),{page:r}=je(t,e),o=(null==r?void 0:r.id)??e,i=t.pages.map((e=>e.id===o?{...e,z:n+1}:e));return{...t,pages:i}})),p(e)}),[m,S]),P=(new Date).getFullYear().toFixed()+"-"+(1+(new Date).getMonth()).toFixed().padStart(2,"0")+"-"+(new Date).getDate().toFixed().padStart(2,"0"),M=(new Date).getHours().toFixed().padStart(2,"0")+":"+(new Date).getMinutes().toFixed().padStart(2,"0"),C=ce((()=>({$date:P,$time:M,$pageIndex:0,$pageId:"Page ID",data:f,$pageData:void 0,$instanceIndex:void 0,$nodeData:void 0})),[P,M]),E=ye((()=>{setTimeout((()=>v((e=>e+1))))}),[]),I=gn(null),[T,U]=j(),[$,A]=j(!1);Ye((()=>{const e=I.current;if(!e)return;U(e.getBoundingClientRect());const t=()=>{U(e.getBoundingClientRect())};return window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t)}}),[]);const L=ce((()=>vo(m,C)),[m,C]);return a("div",{class:"app-root",children:[a(yo,{dataset:C,onScroll:E,leftTab:l,setLeftTab:s,page:x,node:w,setNode:b,setPage:k}),a("div",{style:{flexShrink:1,flexGrow:1,width:"100px",height:"100vh",position:"relative"},children:[a(co,{report:m,dataset:C,setReport:S,setTransition:A,onReportSaved:r,selectedId:d}),a("div",{ref:I,style:{width:"100%",height:"100%"},children:T&&a(Gr,{report:m,evaluated:L,dataset:C,setReport:S,view:c,selectedId:d,setSelectedId:D,onViewportUpdated:e=>{u(e),setTimeout((()=>v((e=>e+1))))},generation:y,setGeneration:v,svgBounds:T,transition:$,shadowRoot:t})}),T&&a(qr,{view:c,setView:u,svgBounds:T})]}),a(mo,{report:m,setView:u,setData:g})]})}class zn extends HTMLElement{constructor(){super()}connectedCallback(){const e=document.createElement("div");e.id="konoha-report-editor";const t=this.attachShadow({mode:"closed"});t.appendChild(e),Kn(a(D,{children:[a("style",{children:er}),a(Do,{shadowRoot:t,source:this.getAttribute("source"),onReportSaved:e=>{const t=new CustomEvent("reportsaved",{bubbles:!0,composed:!0,detail:e});this.dispatchEvent(t)}})]}),e)}}Je(zn,"observedAttributes",["source"]),customElements.define("konoha-report-editor",zn);